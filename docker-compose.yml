version: '3'
services:
  rabbitmq2:
    image: rabbitmq:3-management
    network_mode: host
    hostname: rabbitmq2
    container_name: rabbitmq2
    environment:
      - JOIN_CLUSTER_HOST=rabbitmq1
    volumes:
      - ./.erlang.cookie:/var/lib/rabbitmq/.erlang.cookie
      - ./cluster-entrypoint.sh:/usr/local/bin/cluster-entrypoint.sh
      - /etc/hosts:/etc/hosts
    entrypoint: /usr/local/bin/cluster-entrypoint.sh
    restart: always
